{"ast":null,"code":"/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */'use strict';/**\n * Module dependencies.\n * @private\n */var Route=require('./route');var Layer=require('./layer');var methods=require('methods');var mixin=require('utils-merge');var debug=require('debug')('express:router');var deprecate=require('depd')('express');var flatten=require('array-flatten');var parseUrl=require('parseurl');var setPrototypeOf=require('setprototypeof');/**\n * Module variables.\n * @private\n */var objectRegExp=/^\\[object (\\S+)\\]$/;var slice=Array.prototype.slice;var toString=Object.prototype.toString;/**\n * Initialize a new `Router` with the given `options`.\n *\n * @param {Object} [options]\n * @return {Router} which is an callable function\n * @public\n */var proto=module.exports=function(options){var opts=options||{};function router(req,res,next){router.handle(req,res,next);}// mixin Router class functions\nsetPrototypeOf(router,proto);router.params={};router._params=[];router.caseSensitive=opts.caseSensitive;router.mergeParams=opts.mergeParams;router.strict=opts.strict;router.stack=[];return router;};/**\n * Map the given param placeholder `name`(s) to the given callback.\n *\n * Parameter mapping is used to provide pre-conditions to routes\n * which use normalized placeholders. For example a _:user_id_ parameter\n * could automatically load a user's information from the database without\n * any additional code,\n *\n * The callback uses the same signature as middleware, the only difference\n * being that the value of the placeholder is passed, in this case the _id_\n * of the user. Once the `next()` function is invoked, just like middleware\n * it will continue on to execute the route, or subsequent parameter functions.\n *\n * Just like in middleware, you must either respond to the request or call next\n * to avoid stalling the request.\n *\n *  app.param('user_id', function(req, res, next, id){\n *    User.find(id, function(err, user){\n *      if (err) {\n *        return next(err);\n *      } else if (!user) {\n *        return next(new Error('failed to load user'));\n *      }\n *      req.user = user;\n *      next();\n *    });\n *  });\n *\n * @param {String} name\n * @param {Function} fn\n * @return {app} for chaining\n * @public\n */proto.param=function param(name,fn){// param logic\nif(typeof name==='function'){deprecate('router.param(fn): Refactor to use path params');this._params.push(name);return;}// apply param functions\nvar params=this._params;var len=params.length;var ret;if(name[0]===':'){deprecate('router.param('+JSON.stringify(name)+', fn): Use router.param('+JSON.stringify(name.slice(1))+', fn) instead');name=name.slice(1);}for(var i=0;i<len;++i){if(ret=params[i](name,fn)){fn=ret;}}// ensure we end up with a\n// middleware function\nif('function'!==typeof fn){throw new Error('invalid param() call for '+name+', got '+fn);}(this.params[name]=this.params[name]||[]).push(fn);return this;};/**\n * Dispatch a req, res into the router.\n * @private\n */proto.handle=function handle(req,res,out){var self=this;debug('dispatching %s %s',req.method,req.url);var idx=0;var protohost=getProtohost(req.url)||'';var removed='';var slashAdded=false;var sync=0;var paramcalled={};// store options for OPTIONS request\n// only used if OPTIONS request\nvar options=[];// middleware and routes\nvar stack=self.stack;// manage inter-router variables\nvar parentParams=req.params;var parentUrl=req.baseUrl||'';var done=restore(out,req,'baseUrl','next','params');// setup next layer\nreq.next=next;// for options requests, respond with a default if nothing else responds\nif(req.method==='OPTIONS'){done=wrap(done,function(old,err){if(err||options.length===0)return old(err);sendOptionsResponse(res,options,old);});}// setup basic req values\nreq.baseUrl=parentUrl;req.originalUrl=req.originalUrl||req.url;next();function next(err){var layerError=err==='route'?null:err;// remove added slash\nif(slashAdded){req.url=req.url.slice(1);slashAdded=false;}// restore altered req.url\nif(removed.length!==0){req.baseUrl=parentUrl;req.url=protohost+removed+req.url.slice(protohost.length);removed='';}// signal to exit router\nif(layerError==='router'){setImmediate(done,null);return;}// no more matching layers\nif(idx>=stack.length){setImmediate(done,layerError);return;}// max sync stack\nif(++sync>100){return setImmediate(next,err);}// get pathname of request\nvar path=getPathname(req);if(path==null){return done(layerError);}// find next matching layer\nvar layer;var match;var route;while(match!==true&&idx<stack.length){layer=stack[idx++];match=matchLayer(layer,path);route=layer.route;if(typeof match!=='boolean'){// hold on to layerError\nlayerError=layerError||match;}if(match!==true){continue;}if(!route){// process non-route handlers normally\ncontinue;}if(layerError){// routes do not match with a pending error\nmatch=false;continue;}var method=req.method;var has_method=route._handles_method(method);// build up automatic options response\nif(!has_method&&method==='OPTIONS'){appendMethods(options,route._options());}// don't even bother matching route\nif(!has_method&&method!=='HEAD'){match=false;}}// no match\nif(match!==true){return done(layerError);}// store route for dispatch on change\nif(route){req.route=route;}// Capture one-time layer values\nreq.params=self.mergeParams?mergeParams(layer.params,parentParams):layer.params;var layerPath=layer.path;// this should be done for the layer\nself.process_params(layer,paramcalled,req,res,function(err){if(err){next(layerError||err);}else if(route){layer.handle_request(req,res,next);}else{trim_prefix(layer,layerError,layerPath,path);}sync=0;});}function trim_prefix(layer,layerError,layerPath,path){if(layerPath.length!==0){// Validate path is a prefix match\nif(layerPath!==path.slice(0,layerPath.length)){next(layerError);return;}// Validate path breaks on a path separator\nvar c=path[layerPath.length];if(c&&c!=='/'&&c!=='.')return next(layerError);// Trim off the part of the url that matches the route\n// middleware (.use stuff) needs to have the path stripped\ndebug('trim prefix (%s) from url %s',layerPath,req.url);removed=layerPath;req.url=protohost+req.url.slice(protohost.length+removed.length);// Ensure leading slash\nif(!protohost&&req.url[0]!=='/'){req.url='/'+req.url;slashAdded=true;}// Setup base URL (no trailing slash)\nreq.baseUrl=parentUrl+(removed[removed.length-1]==='/'?removed.substring(0,removed.length-1):removed);}debug('%s %s : %s',layer.name,layerPath,req.originalUrl);if(layerError){layer.handle_error(layerError,req,res,next);}else{layer.handle_request(req,res,next);}}};/**\n * Process any parameters for the layer.\n * @private\n */proto.process_params=function process_params(layer,called,req,res,done){var params=this.params;// captured parameters from the layer, keys and values\nvar keys=layer.keys;// fast track\nif(!keys||keys.length===0){return done();}var i=0;var name;var paramIndex=0;var key;var paramVal;var paramCallbacks;var paramCalled;// process params in order\n// param callbacks can be async\nfunction param(err){if(err){return done(err);}if(i>=keys.length){return done();}paramIndex=0;key=keys[i++];name=key.name;paramVal=req.params[name];paramCallbacks=params[name];paramCalled=called[name];if(paramVal===undefined||!paramCallbacks){return param();}// param previously called with same value or error occurred\nif(paramCalled&&(paramCalled.match===paramVal||paramCalled.error&&paramCalled.error!=='route')){// restore value\nreq.params[name]=paramCalled.value;// next param\nreturn param(paramCalled.error);}called[name]=paramCalled={error:null,match:paramVal,value:paramVal};paramCallback();}// single param callbacks\nfunction paramCallback(err){var fn=paramCallbacks[paramIndex++];// store updated value\nparamCalled.value=req.params[key.name];if(err){// store error\nparamCalled.error=err;param(err);return;}if(!fn)return param();try{fn(req,res,paramCallback,paramVal,key.name);}catch(e){paramCallback(e);}}param();};/**\n * Use the given middleware function, with optional path, defaulting to \"/\".\n *\n * Use (like `.all`) will run for any http METHOD, but it will not add\n * handlers for those methods so OPTIONS requests will not consider `.use`\n * functions even if they could respond.\n *\n * The other difference is that _route_ path is stripped and not visible\n * to the handler function. The main effect of this feature is that mounted\n * handlers can operate without any code changes regardless of the \"prefix\"\n * pathname.\n *\n * @public\n */proto.use=function use(fn){var offset=0;var path='/';// default path to '/'\n// disambiguate router.use([fn])\nif(typeof fn!=='function'){var arg=fn;while(Array.isArray(arg)&&arg.length!==0){arg=arg[0];}// first arg is the path\nif(typeof arg!=='function'){offset=1;path=fn;}}var callbacks=flatten(slice.call(arguments,offset));if(callbacks.length===0){throw new TypeError('Router.use() requires a middleware function');}for(var i=0;i<callbacks.length;i++){var fn=callbacks[i];if(typeof fn!=='function'){throw new TypeError('Router.use() requires a middleware function but got a '+gettype(fn));}// add the middleware\ndebug('use %o %s',path,fn.name||'<anonymous>');var layer=new Layer(path,{sensitive:this.caseSensitive,strict:false,end:false},fn);layer.route=undefined;this.stack.push(layer);}return this;};/**\n * Create a new Route for the given path.\n *\n * Each route contains a separate middleware stack and VERB handlers.\n *\n * See the Route api documentation for details on adding handlers\n * and middleware to routes.\n *\n * @param {String} path\n * @return {Route}\n * @public\n */proto.route=function route(path){var route=new Route(path);var layer=new Layer(path,{sensitive:this.caseSensitive,strict:this.strict,end:true},route.dispatch.bind(route));layer.route=route;this.stack.push(layer);return route;};// create Router#VERB functions\nmethods.concat('all').forEach(function(method){proto[method]=function(path){var route=this.route(path);route[method].apply(route,slice.call(arguments,1));return this;};});// append methods to a list of methods\nfunction appendMethods(list,addition){for(var i=0;i<addition.length;i++){var method=addition[i];if(list.indexOf(method)===-1){list.push(method);}}}// get pathname of request\nfunction getPathname(req){try{return parseUrl(req).pathname;}catch(err){return undefined;}}// Get get protocol + host for a URL\nfunction getProtohost(url){if(typeof url!=='string'||url.length===0||url[0]==='/'){return undefined;}var searchIndex=url.indexOf('?');var pathLength=searchIndex!==-1?searchIndex:url.length;var fqdnIndex=url.slice(0,pathLength).indexOf('://');return fqdnIndex!==-1?url.substring(0,url.indexOf('/',3+fqdnIndex)):undefined;}// get type for error message\nfunction gettype(obj){var type=typeof obj;if(type!=='object'){return type;}// inspect [[Class]] for objects\nreturn toString.call(obj).replace(objectRegExp,'$1');}/**\n * Match path to a layer.\n *\n * @param {Layer} layer\n * @param {string} path\n * @private\n */function matchLayer(layer,path){try{return layer.match(path);}catch(err){return err;}}// merge params with parent params\nfunction mergeParams(params,parent){if(typeof parent!=='object'||!parent){return params;}// make copy of parent for base\nvar obj=mixin({},parent);// simple non-numeric merging\nif(!(0 in params)||!(0 in parent)){return mixin(obj,params);}var i=0;var o=0;// determine numeric gaps\nwhile(i in params){i++;}while(o in parent){o++;}// offset numeric indices in params before merge\nfor(i--;i>=0;i--){params[i+o]=params[i];// create holes for the merge when necessary\nif(i<o){delete params[i];}}return mixin(obj,params);}// restore obj props after function\nfunction restore(fn,obj){var props=new Array(arguments.length-2);var vals=new Array(arguments.length-2);for(var i=0;i<props.length;i++){props[i]=arguments[i+2];vals[i]=obj[props[i]];}return function(){// restore vals\nfor(var i=0;i<props.length;i++){obj[props[i]]=vals[i];}return fn.apply(this,arguments);};}// send an OPTIONS response\nfunction sendOptionsResponse(res,options,next){try{var body=options.join(',');res.set('Allow',body);res.send(body);}catch(err){next(err);}}// wrap a function\nfunction wrap(old,fn){return function proxy(){var args=new Array(arguments.length+1);args[0]=old;for(var i=0,len=arguments.length;i<len;i++){args[i+1]=arguments[i];}fn.apply(this,args);};}","map":{"version":3,"names":["Route","require","Layer","methods","mixin","debug","deprecate","flatten","parseUrl","setPrototypeOf","objectRegExp","slice","Array","prototype","toString","Object","proto","module","exports","options","opts","router","req","res","next","handle","params","_params","caseSensitive","mergeParams","strict","stack","param","name","fn","push","len","length","ret","JSON","stringify","i","Error","out","self","method","url","idx","protohost","getProtohost","removed","slashAdded","sync","paramcalled","parentParams","parentUrl","baseUrl","done","restore","wrap","old","err","sendOptionsResponse","originalUrl","layerError","setImmediate","path","getPathname","layer","match","route","matchLayer","has_method","_handles_method","appendMethods","_options","layerPath","process_params","handle_request","trim_prefix","c","substring","handle_error","called","keys","paramIndex","key","paramVal","paramCallbacks","paramCalled","undefined","error","value","paramCallback","e","use","offset","arg","isArray","callbacks","call","arguments","TypeError","gettype","sensitive","end","dispatch","bind","concat","forEach","apply","list","addition","indexOf","pathname","searchIndex","pathLength","fqdnIndex","obj","type","replace","parent","o","props","vals","body","join","set","send","proxy","args"],"sources":["C:/Users/Autor/Desktop/LaRuinaTV/api/src/Routes/server/node_modules/express/lib/router/index.js"],"sourcesContent":["/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar Route = require('./route');\nvar Layer = require('./layer');\nvar methods = require('methods');\nvar mixin = require('utils-merge');\nvar debug = require('debug')('express:router');\nvar deprecate = require('depd')('express');\nvar flatten = require('array-flatten');\nvar parseUrl = require('parseurl');\nvar setPrototypeOf = require('setprototypeof')\n\n/**\n * Module variables.\n * @private\n */\n\nvar objectRegExp = /^\\[object (\\S+)\\]$/;\nvar slice = Array.prototype.slice;\nvar toString = Object.prototype.toString;\n\n/**\n * Initialize a new `Router` with the given `options`.\n *\n * @param {Object} [options]\n * @return {Router} which is an callable function\n * @public\n */\n\nvar proto = module.exports = function(options) {\n  var opts = options || {};\n\n  function router(req, res, next) {\n    router.handle(req, res, next);\n  }\n\n  // mixin Router class functions\n  setPrototypeOf(router, proto)\n\n  router.params = {};\n  router._params = [];\n  router.caseSensitive = opts.caseSensitive;\n  router.mergeParams = opts.mergeParams;\n  router.strict = opts.strict;\n  router.stack = [];\n\n  return router;\n};\n\n/**\n * Map the given param placeholder `name`(s) to the given callback.\n *\n * Parameter mapping is used to provide pre-conditions to routes\n * which use normalized placeholders. For example a _:user_id_ parameter\n * could automatically load a user's information from the database without\n * any additional code,\n *\n * The callback uses the same signature as middleware, the only difference\n * being that the value of the placeholder is passed, in this case the _id_\n * of the user. Once the `next()` function is invoked, just like middleware\n * it will continue on to execute the route, or subsequent parameter functions.\n *\n * Just like in middleware, you must either respond to the request or call next\n * to avoid stalling the request.\n *\n *  app.param('user_id', function(req, res, next, id){\n *    User.find(id, function(err, user){\n *      if (err) {\n *        return next(err);\n *      } else if (!user) {\n *        return next(new Error('failed to load user'));\n *      }\n *      req.user = user;\n *      next();\n *    });\n *  });\n *\n * @param {String} name\n * @param {Function} fn\n * @return {app} for chaining\n * @public\n */\n\nproto.param = function param(name, fn) {\n  // param logic\n  if (typeof name === 'function') {\n    deprecate('router.param(fn): Refactor to use path params');\n    this._params.push(name);\n    return;\n  }\n\n  // apply param functions\n  var params = this._params;\n  var len = params.length;\n  var ret;\n\n  if (name[0] === ':') {\n    deprecate('router.param(' + JSON.stringify(name) + ', fn): Use router.param(' + JSON.stringify(name.slice(1)) + ', fn) instead')\n    name = name.slice(1)\n  }\n\n  for (var i = 0; i < len; ++i) {\n    if (ret = params[i](name, fn)) {\n      fn = ret;\n    }\n  }\n\n  // ensure we end up with a\n  // middleware function\n  if ('function' !== typeof fn) {\n    throw new Error('invalid param() call for ' + name + ', got ' + fn);\n  }\n\n  (this.params[name] = this.params[name] || []).push(fn);\n  return this;\n};\n\n/**\n * Dispatch a req, res into the router.\n * @private\n */\n\nproto.handle = function handle(req, res, out) {\n  var self = this;\n\n  debug('dispatching %s %s', req.method, req.url);\n\n  var idx = 0;\n  var protohost = getProtohost(req.url) || ''\n  var removed = '';\n  var slashAdded = false;\n  var sync = 0\n  var paramcalled = {};\n\n  // store options for OPTIONS request\n  // only used if OPTIONS request\n  var options = [];\n\n  // middleware and routes\n  var stack = self.stack;\n\n  // manage inter-router variables\n  var parentParams = req.params;\n  var parentUrl = req.baseUrl || '';\n  var done = restore(out, req, 'baseUrl', 'next', 'params');\n\n  // setup next layer\n  req.next = next;\n\n  // for options requests, respond with a default if nothing else responds\n  if (req.method === 'OPTIONS') {\n    done = wrap(done, function(old, err) {\n      if (err || options.length === 0) return old(err);\n      sendOptionsResponse(res, options, old);\n    });\n  }\n\n  // setup basic req values\n  req.baseUrl = parentUrl;\n  req.originalUrl = req.originalUrl || req.url;\n\n  next();\n\n  function next(err) {\n    var layerError = err === 'route'\n      ? null\n      : err;\n\n    // remove added slash\n    if (slashAdded) {\n      req.url = req.url.slice(1)\n      slashAdded = false;\n    }\n\n    // restore altered req.url\n    if (removed.length !== 0) {\n      req.baseUrl = parentUrl;\n      req.url = protohost + removed + req.url.slice(protohost.length)\n      removed = '';\n    }\n\n    // signal to exit router\n    if (layerError === 'router') {\n      setImmediate(done, null)\n      return\n    }\n\n    // no more matching layers\n    if (idx >= stack.length) {\n      setImmediate(done, layerError);\n      return;\n    }\n\n    // max sync stack\n    if (++sync > 100) {\n      return setImmediate(next, err)\n    }\n\n    // get pathname of request\n    var path = getPathname(req);\n\n    if (path == null) {\n      return done(layerError);\n    }\n\n    // find next matching layer\n    var layer;\n    var match;\n    var route;\n\n    while (match !== true && idx < stack.length) {\n      layer = stack[idx++];\n      match = matchLayer(layer, path);\n      route = layer.route;\n\n      if (typeof match !== 'boolean') {\n        // hold on to layerError\n        layerError = layerError || match;\n      }\n\n      if (match !== true) {\n        continue;\n      }\n\n      if (!route) {\n        // process non-route handlers normally\n        continue;\n      }\n\n      if (layerError) {\n        // routes do not match with a pending error\n        match = false;\n        continue;\n      }\n\n      var method = req.method;\n      var has_method = route._handles_method(method);\n\n      // build up automatic options response\n      if (!has_method && method === 'OPTIONS') {\n        appendMethods(options, route._options());\n      }\n\n      // don't even bother matching route\n      if (!has_method && method !== 'HEAD') {\n        match = false;\n      }\n    }\n\n    // no match\n    if (match !== true) {\n      return done(layerError);\n    }\n\n    // store route for dispatch on change\n    if (route) {\n      req.route = route;\n    }\n\n    // Capture one-time layer values\n    req.params = self.mergeParams\n      ? mergeParams(layer.params, parentParams)\n      : layer.params;\n    var layerPath = layer.path;\n\n    // this should be done for the layer\n    self.process_params(layer, paramcalled, req, res, function (err) {\n      if (err) {\n        next(layerError || err)\n      } else if (route) {\n        layer.handle_request(req, res, next)\n      } else {\n        trim_prefix(layer, layerError, layerPath, path)\n      }\n\n      sync = 0\n    });\n  }\n\n  function trim_prefix(layer, layerError, layerPath, path) {\n    if (layerPath.length !== 0) {\n      // Validate path is a prefix match\n      if (layerPath !== path.slice(0, layerPath.length)) {\n        next(layerError)\n        return\n      }\n\n      // Validate path breaks on a path separator\n      var c = path[layerPath.length]\n      if (c && c !== '/' && c !== '.') return next(layerError)\n\n      // Trim off the part of the url that matches the route\n      // middleware (.use stuff) needs to have the path stripped\n      debug('trim prefix (%s) from url %s', layerPath, req.url);\n      removed = layerPath;\n      req.url = protohost + req.url.slice(protohost.length + removed.length)\n\n      // Ensure leading slash\n      if (!protohost && req.url[0] !== '/') {\n        req.url = '/' + req.url;\n        slashAdded = true;\n      }\n\n      // Setup base URL (no trailing slash)\n      req.baseUrl = parentUrl + (removed[removed.length - 1] === '/'\n        ? removed.substring(0, removed.length - 1)\n        : removed);\n    }\n\n    debug('%s %s : %s', layer.name, layerPath, req.originalUrl);\n\n    if (layerError) {\n      layer.handle_error(layerError, req, res, next);\n    } else {\n      layer.handle_request(req, res, next);\n    }\n  }\n};\n\n/**\n * Process any parameters for the layer.\n * @private\n */\n\nproto.process_params = function process_params(layer, called, req, res, done) {\n  var params = this.params;\n\n  // captured parameters from the layer, keys and values\n  var keys = layer.keys;\n\n  // fast track\n  if (!keys || keys.length === 0) {\n    return done();\n  }\n\n  var i = 0;\n  var name;\n  var paramIndex = 0;\n  var key;\n  var paramVal;\n  var paramCallbacks;\n  var paramCalled;\n\n  // process params in order\n  // param callbacks can be async\n  function param(err) {\n    if (err) {\n      return done(err);\n    }\n\n    if (i >= keys.length ) {\n      return done();\n    }\n\n    paramIndex = 0;\n    key = keys[i++];\n    name = key.name;\n    paramVal = req.params[name];\n    paramCallbacks = params[name];\n    paramCalled = called[name];\n\n    if (paramVal === undefined || !paramCallbacks) {\n      return param();\n    }\n\n    // param previously called with same value or error occurred\n    if (paramCalled && (paramCalled.match === paramVal\n      || (paramCalled.error && paramCalled.error !== 'route'))) {\n      // restore value\n      req.params[name] = paramCalled.value;\n\n      // next param\n      return param(paramCalled.error);\n    }\n\n    called[name] = paramCalled = {\n      error: null,\n      match: paramVal,\n      value: paramVal\n    };\n\n    paramCallback();\n  }\n\n  // single param callbacks\n  function paramCallback(err) {\n    var fn = paramCallbacks[paramIndex++];\n\n    // store updated value\n    paramCalled.value = req.params[key.name];\n\n    if (err) {\n      // store error\n      paramCalled.error = err;\n      param(err);\n      return;\n    }\n\n    if (!fn) return param();\n\n    try {\n      fn(req, res, paramCallback, paramVal, key.name);\n    } catch (e) {\n      paramCallback(e);\n    }\n  }\n\n  param();\n};\n\n/**\n * Use the given middleware function, with optional path, defaulting to \"/\".\n *\n * Use (like `.all`) will run for any http METHOD, but it will not add\n * handlers for those methods so OPTIONS requests will not consider `.use`\n * functions even if they could respond.\n *\n * The other difference is that _route_ path is stripped and not visible\n * to the handler function. The main effect of this feature is that mounted\n * handlers can operate without any code changes regardless of the \"prefix\"\n * pathname.\n *\n * @public\n */\n\nproto.use = function use(fn) {\n  var offset = 0;\n  var path = '/';\n\n  // default path to '/'\n  // disambiguate router.use([fn])\n  if (typeof fn !== 'function') {\n    var arg = fn;\n\n    while (Array.isArray(arg) && arg.length !== 0) {\n      arg = arg[0];\n    }\n\n    // first arg is the path\n    if (typeof arg !== 'function') {\n      offset = 1;\n      path = fn;\n    }\n  }\n\n  var callbacks = flatten(slice.call(arguments, offset));\n\n  if (callbacks.length === 0) {\n    throw new TypeError('Router.use() requires a middleware function')\n  }\n\n  for (var i = 0; i < callbacks.length; i++) {\n    var fn = callbacks[i];\n\n    if (typeof fn !== 'function') {\n      throw new TypeError('Router.use() requires a middleware function but got a ' + gettype(fn))\n    }\n\n    // add the middleware\n    debug('use %o %s', path, fn.name || '<anonymous>')\n\n    var layer = new Layer(path, {\n      sensitive: this.caseSensitive,\n      strict: false,\n      end: false\n    }, fn);\n\n    layer.route = undefined;\n\n    this.stack.push(layer);\n  }\n\n  return this;\n};\n\n/**\n * Create a new Route for the given path.\n *\n * Each route contains a separate middleware stack and VERB handlers.\n *\n * See the Route api documentation for details on adding handlers\n * and middleware to routes.\n *\n * @param {String} path\n * @return {Route}\n * @public\n */\n\nproto.route = function route(path) {\n  var route = new Route(path);\n\n  var layer = new Layer(path, {\n    sensitive: this.caseSensitive,\n    strict: this.strict,\n    end: true\n  }, route.dispatch.bind(route));\n\n  layer.route = route;\n\n  this.stack.push(layer);\n  return route;\n};\n\n// create Router#VERB functions\nmethods.concat('all').forEach(function(method){\n  proto[method] = function(path){\n    var route = this.route(path)\n    route[method].apply(route, slice.call(arguments, 1));\n    return this;\n  };\n});\n\n// append methods to a list of methods\nfunction appendMethods(list, addition) {\n  for (var i = 0; i < addition.length; i++) {\n    var method = addition[i];\n    if (list.indexOf(method) === -1) {\n      list.push(method);\n    }\n  }\n}\n\n// get pathname of request\nfunction getPathname(req) {\n  try {\n    return parseUrl(req).pathname;\n  } catch (err) {\n    return undefined;\n  }\n}\n\n// Get get protocol + host for a URL\nfunction getProtohost(url) {\n  if (typeof url !== 'string' || url.length === 0 || url[0] === '/') {\n    return undefined\n  }\n\n  var searchIndex = url.indexOf('?')\n  var pathLength = searchIndex !== -1\n    ? searchIndex\n    : url.length\n  var fqdnIndex = url.slice(0, pathLength).indexOf('://')\n\n  return fqdnIndex !== -1\n    ? url.substring(0, url.indexOf('/', 3 + fqdnIndex))\n    : undefined\n}\n\n// get type for error message\nfunction gettype(obj) {\n  var type = typeof obj;\n\n  if (type !== 'object') {\n    return type;\n  }\n\n  // inspect [[Class]] for objects\n  return toString.call(obj)\n    .replace(objectRegExp, '$1');\n}\n\n/**\n * Match path to a layer.\n *\n * @param {Layer} layer\n * @param {string} path\n * @private\n */\n\nfunction matchLayer(layer, path) {\n  try {\n    return layer.match(path);\n  } catch (err) {\n    return err;\n  }\n}\n\n// merge params with parent params\nfunction mergeParams(params, parent) {\n  if (typeof parent !== 'object' || !parent) {\n    return params;\n  }\n\n  // make copy of parent for base\n  var obj = mixin({}, parent);\n\n  // simple non-numeric merging\n  if (!(0 in params) || !(0 in parent)) {\n    return mixin(obj, params);\n  }\n\n  var i = 0;\n  var o = 0;\n\n  // determine numeric gaps\n  while (i in params) {\n    i++;\n  }\n\n  while (o in parent) {\n    o++;\n  }\n\n  // offset numeric indices in params before merge\n  for (i--; i >= 0; i--) {\n    params[i + o] = params[i];\n\n    // create holes for the merge when necessary\n    if (i < o) {\n      delete params[i];\n    }\n  }\n\n  return mixin(obj, params);\n}\n\n// restore obj props after function\nfunction restore(fn, obj) {\n  var props = new Array(arguments.length - 2);\n  var vals = new Array(arguments.length - 2);\n\n  for (var i = 0; i < props.length; i++) {\n    props[i] = arguments[i + 2];\n    vals[i] = obj[props[i]];\n  }\n\n  return function () {\n    // restore vals\n    for (var i = 0; i < props.length; i++) {\n      obj[props[i]] = vals[i];\n    }\n\n    return fn.apply(this, arguments);\n  };\n}\n\n// send an OPTIONS response\nfunction sendOptionsResponse(res, options, next) {\n  try {\n    var body = options.join(',');\n    res.set('Allow', body);\n    res.send(body);\n  } catch (err) {\n    next(err);\n  }\n}\n\n// wrap a function\nfunction wrap(old, fn) {\n  return function proxy() {\n    var args = new Array(arguments.length + 1);\n\n    args[0] = old;\n    for (var i = 0, len = arguments.length; i < len; i++) {\n      args[i + 1] = arguments[i];\n    }\n\n    fn.apply(this, args);\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}