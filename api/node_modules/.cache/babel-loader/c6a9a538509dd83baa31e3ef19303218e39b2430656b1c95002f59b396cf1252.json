{"ast":null,"code":"/*!\n * on-finished\n * Copyright(c) 2013 Jonathan Ong\n * Copyright(c) 2014 Douglas Christopher Wilson\n * MIT Licensed\n */'use strict';/**\n * Module exports.\n * @public\n */module.exports=onFinished;module.exports.isFinished=isFinished;/**\n * Module dependencies.\n * @private\n */var first=require('ee-first');/**\n * Variables.\n * @private\n */ /* istanbul ignore next */var defer=typeof setImmediate==='function'?setImmediate:function(fn){process.nextTick(fn.bind.apply(fn,arguments));};/**\n * Invoke callback when the response has finished, useful for\n * cleaning up resources afterwards.\n *\n * @param {object} msg\n * @param {function} listener\n * @return {object}\n * @public\n */function onFinished(msg,listener){if(isFinished(msg)!==false){defer(listener,null,msg);return msg;}// attach the listener to the message\nattachListener(msg,listener);return msg;}/**\n * Determine if message is already finished.\n *\n * @param {object} msg\n * @return {boolean}\n * @public\n */function isFinished(msg){var socket=msg.socket;if(typeof msg.finished==='boolean'){// OutgoingMessage\nreturn Boolean(msg.finished||socket&&!socket.writable);}if(typeof msg.complete==='boolean'){// IncomingMessage\nreturn Boolean(msg.upgrade||!socket||!socket.readable||msg.complete&&!msg.readable);}// don't know\nreturn undefined;}/**\n * Attach a finished listener to the message.\n *\n * @param {object} msg\n * @param {function} callback\n * @private\n */function attachFinishedListener(msg,callback){var eeMsg;var eeSocket;var finished=false;function onFinish(error){eeMsg.cancel();eeSocket.cancel();finished=true;callback(error);}// finished on first message event\neeMsg=eeSocket=first([[msg,'end','finish']],onFinish);function onSocket(socket){// remove listener\nmsg.removeListener('socket',onSocket);if(finished)return;if(eeMsg!==eeSocket)return;// finished on first socket event\neeSocket=first([[socket,'error','close']],onFinish);}if(msg.socket){// socket already assigned\nonSocket(msg.socket);return;}// wait for socket to be assigned\nmsg.on('socket',onSocket);if(msg.socket===undefined){// node.js 0.8 patch\npatchAssignSocket(msg,onSocket);}}/**\n * Attach the listener to the message.\n *\n * @param {object} msg\n * @return {function}\n * @private\n */function attachListener(msg,listener){var attached=msg.__onFinished;// create a private single listener with queue\nif(!attached||!attached.queue){attached=msg.__onFinished=createListener(msg);attachFinishedListener(msg,attached);}attached.queue.push(listener);}/**\n * Create listener on message.\n *\n * @param {object} msg\n * @return {function}\n * @private\n */function createListener(msg){function listener(err){if(msg.__onFinished===listener)msg.__onFinished=null;if(!listener.queue)return;var queue=listener.queue;listener.queue=null;for(var i=0;i<queue.length;i++){queue[i](err,msg);}}listener.queue=[];return listener;}/**\n * Patch ServerResponse.prototype.assignSocket for node.js 0.8.\n *\n * @param {ServerResponse} res\n * @param {function} callback\n * @private\n */function patchAssignSocket(res,callback){var assignSocket=res.assignSocket;if(typeof assignSocket!=='function')return;// res.on('socket', callback) is broken in 0.8\nres.assignSocket=function _assignSocket(socket){assignSocket.call(this,socket);callback(socket);};}","map":{"version":3,"names":["module","exports","onFinished","isFinished","first","require","defer","setImmediate","fn","process","nextTick","bind","apply","arguments","msg","listener","attachListener","socket","finished","Boolean","writable","complete","upgrade","readable","undefined","attachFinishedListener","callback","eeMsg","eeSocket","onFinish","error","cancel","onSocket","removeListener","on","patchAssignSocket","attached","__onFinished","queue","createListener","push","err","i","length","res","assignSocket","_assignSocket","call"],"sources":["C:/Users/Autor/Desktop/LaRuinaTV/api/src/node_modules/morgan/node_modules/on-finished/index.js"],"sourcesContent":["/*!\n * on-finished\n * Copyright(c) 2013 Jonathan Ong\n * Copyright(c) 2014 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = onFinished\nmodule.exports.isFinished = isFinished\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar first = require('ee-first')\n\n/**\n * Variables.\n * @private\n */\n\n/* istanbul ignore next */\nvar defer = typeof setImmediate === 'function'\n  ? setImmediate\n  : function(fn){ process.nextTick(fn.bind.apply(fn, arguments)) }\n\n/**\n * Invoke callback when the response has finished, useful for\n * cleaning up resources afterwards.\n *\n * @param {object} msg\n * @param {function} listener\n * @return {object}\n * @public\n */\n\nfunction onFinished(msg, listener) {\n  if (isFinished(msg) !== false) {\n    defer(listener, null, msg)\n    return msg\n  }\n\n  // attach the listener to the message\n  attachListener(msg, listener)\n\n  return msg\n}\n\n/**\n * Determine if message is already finished.\n *\n * @param {object} msg\n * @return {boolean}\n * @public\n */\n\nfunction isFinished(msg) {\n  var socket = msg.socket\n\n  if (typeof msg.finished === 'boolean') {\n    // OutgoingMessage\n    return Boolean(msg.finished || (socket && !socket.writable))\n  }\n\n  if (typeof msg.complete === 'boolean') {\n    // IncomingMessage\n    return Boolean(msg.upgrade || !socket || !socket.readable || (msg.complete && !msg.readable))\n  }\n\n  // don't know\n  return undefined\n}\n\n/**\n * Attach a finished listener to the message.\n *\n * @param {object} msg\n * @param {function} callback\n * @private\n */\n\nfunction attachFinishedListener(msg, callback) {\n  var eeMsg\n  var eeSocket\n  var finished = false\n\n  function onFinish(error) {\n    eeMsg.cancel()\n    eeSocket.cancel()\n\n    finished = true\n    callback(error)\n  }\n\n  // finished on first message event\n  eeMsg = eeSocket = first([[msg, 'end', 'finish']], onFinish)\n\n  function onSocket(socket) {\n    // remove listener\n    msg.removeListener('socket', onSocket)\n\n    if (finished) return\n    if (eeMsg !== eeSocket) return\n\n    // finished on first socket event\n    eeSocket = first([[socket, 'error', 'close']], onFinish)\n  }\n\n  if (msg.socket) {\n    // socket already assigned\n    onSocket(msg.socket)\n    return\n  }\n\n  // wait for socket to be assigned\n  msg.on('socket', onSocket)\n\n  if (msg.socket === undefined) {\n    // node.js 0.8 patch\n    patchAssignSocket(msg, onSocket)\n  }\n}\n\n/**\n * Attach the listener to the message.\n *\n * @param {object} msg\n * @return {function}\n * @private\n */\n\nfunction attachListener(msg, listener) {\n  var attached = msg.__onFinished\n\n  // create a private single listener with queue\n  if (!attached || !attached.queue) {\n    attached = msg.__onFinished = createListener(msg)\n    attachFinishedListener(msg, attached)\n  }\n\n  attached.queue.push(listener)\n}\n\n/**\n * Create listener on message.\n *\n * @param {object} msg\n * @return {function}\n * @private\n */\n\nfunction createListener(msg) {\n  function listener(err) {\n    if (msg.__onFinished === listener) msg.__onFinished = null\n    if (!listener.queue) return\n\n    var queue = listener.queue\n    listener.queue = null\n\n    for (var i = 0; i < queue.length; i++) {\n      queue[i](err, msg)\n    }\n  }\n\n  listener.queue = []\n\n  return listener\n}\n\n/**\n * Patch ServerResponse.prototype.assignSocket for node.js 0.8.\n *\n * @param {ServerResponse} res\n * @param {function} callback\n * @private\n */\n\nfunction patchAssignSocket(res, callback) {\n  var assignSocket = res.assignSocket\n\n  if (typeof assignSocket !== 'function') return\n\n  // res.on('socket', callback) is broken in 0.8\n  res.assignSocket = function _assignSocket(socket) {\n    assignSocket.call(this, socket)\n    callback(socket)\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}